/*=============================================================================
 * Environnement Canada
 * Centre Meteorologique Canadian
 * 2100 Trans-Canadienne
 * Dorval, Quebec
 *
 * Projet       : Projection diverses de la carte vectorielle.
 * Fichier      : Matrix.c
 * Creation     : Mars 2011 - J.P. Gauthier
 *
 * Description: Fichier de definition des parametres et fonctions de matrices.
 *
 * Remarques :
 *
 * Modification:
 *
 *   Nom         :
 *   Date        :
 *   Description :
 *
 *==============================================================================
 */

#include "Matrix.h"

void Matrix_MxM(Matrix4d MR,Matrix4d M1,Matrix4d M2) {

   MR[0][0]=M1[0][0]*M2[0][0]+M1[0][1]*M2[1][0]+M1[0][2]*M2[2][0]+M1[0][3]*M2[3][0];
   MR[0][1]=M1[0][0]*M2[0][1]+M1[0][1]*M2[1][1]+M1[0][2]*M2[2][1]+M1[0][3]*M2[3][1];
   MR[0][2]=M1[0][0]*M2[0][2]+M1[0][1]*M2[1][2]+M1[0][2]*M2[2][2]+M1[0][3]*M2[3][2];
   MR[0][3]=M1[0][0]*M2[0][3]+M1[0][1]*M2[1][3]+M1[0][2]*M2[2][3]+M1[0][3]*M2[3][3];
   MR[1][0]=M1[2][0]*M2[0][0]+M1[1][1]*M2[1][0]+M1[1][2]*M2[2][0]+M1[1][3]*M2[3][0];
   MR[1][1]=M1[1][0]*M2[0][1]+M1[1][1]*M2[1][1]+M1[1][2]*M2[2][1]+M1[1][3]*M2[3][1];
   MR[1][2]=M1[1][0]*M2[0][2]+M1[1][1]*M2[1][2]+M1[1][2]*M2[2][2]+M1[1][3]*M2[3][2];
   MR[1][3]=M1[1][0]*M2[0][3]+M1[1][1]*M2[1][3]+M1[1][2]*M2[2][3]+M1[1][3]*M2[3][3];
   MR[2][0]=M1[2][0]*M2[0][0]+M1[2][1]*M2[1][0]+M1[2][2]*M2[2][0]+M1[2][3]*M2[3][0];
   MR[2][1]=M1[2][0]*M2[0][1]+M1[2][1]*M2[1][1]+M1[2][2]*M2[2][1]+M1[2][3]*M2[3][1];
   MR[2][2]=M1[2][0]*M2[0][2]+M1[2][1]*M2[1][2]+M1[2][2]*M2[2][2]+M1[2][3]*M2[3][2];
   MR[2][3]=M1[2][0]*M2[0][3]+M1[2][1]*M2[1][3]+M1[2][2]*M2[2][3]+M1[2][3]*M2[3][3];
   MR[3][0]=M1[3][0]*M2[0][0]+M1[3][1]*M2[1][0]+M1[3][2]*M2[2][0]+M1[3][3]*M2[3][0];
   MR[3][1]=M1[3][0]*M2[0][1]+M1[3][1]*M2[1][1]+M1[3][2]*M2[2][1]+M1[3][3]*M2[3][1];
   MR[3][2]=M1[3][0]*M2[0][2]+M1[3][1]*M2[1][2]+M1[3][2]*M2[2][2]+M1[3][3]*M2[3][2];
   MR[3][3]=M1[3][0]*M2[0][3]+M1[3][1]*M2[1][3]+M1[3][2]*M2[2][3]+M1[3][3]*M2[3][3];
}

void Matrix_VxM(Vect3d VR,Vect3d V,Matrix4d M) {

   VR[0]=M[0][0]*V[0]+M[1][0]*V[1]+M[2][0]*V[2];
   VR[1]=M[0][1]*V[0]+M[1][1]*V[1]+M[2][1]*V[2];
   VR[2]=M[0][2]*V[0]+M[1][2]*V[1]+M[2][2]*V[2];
}

double Matrix_Determinant(Matrix4d M) {

   double det;

   det=
   M[0][3]*M[1][2]*M[2][1]*M[3][0] - M[0][2]*M[1][3]*M[2][1]*M[3][0] - M[0][3]*M[1][1]*M[2][2]*M[3][0] + M[0][1]*M[1][3]*M[2][2]*M[3][0]+
   M[0][2]*M[1][1]*M[2][3]*M[3][0] - M[0][1]*M[1][2]*M[2][3]*M[3][0] - M[0][3]*M[1][2]*M[2][0]*M[3][1] + M[0][2]*M[1][3]*M[2][0]*M[3][1]+
   M[0][3]*M[1][0]*M[2][2]*M[3][1] - M[0][0]*M[1][3]*M[2][2]*M[3][1] - M[0][2]*M[1][0]*M[2][3]*M[3][1] + M[0][0]*M[1][2]*M[2][3]*M[3][1]+
   M[0][3]*M[1][1]*M[2][0]*M[3][2] - M[0][1]*M[1][3]*M[2][0]*M[3][2] - M[0][3]*M[1][0]*M[2][1]*M[3][2] + M[0][0]*M[1][3]*M[2][1]*M[3][2]+
   M[0][1]*M[1][0]*M[2][3]*M[3][2] - M[0][0]*M[1][1]*M[2][3]*M[3][2] - M[0][2]*M[1][1]*M[2][0]*M[3][3] + M[0][1]*M[1][2]*M[2][0]*M[3][3]+
   M[0][2]*M[1][0]*M[2][1]*M[3][3] - M[0][0]*M[1][2]*M[2][1]*M[3][3] - M[0][1]*M[1][0]*M[2][2]*M[3][3] + M[0][0]*M[1][1]*M[2][2]*M[3][3];

   return(det);
}
